<!DOCTYPE html>
<html>

	<head>
		<title>tri-d-chess</title>
		<style>
			body {
				background-color: #000;
				color: #000;
				margin: 0;
			}

			canvas {
				width: 100%;
				height: 100%;
			}
		</style>
	</head>

	<body>
		<script src="js/three.js/three.min.js"></script>
		<script src="js/three.js/controls/OrbitControls.js"></script>
		<script src="js/three.js/controls/DragControls.js"></script>

		<script src="js/tridchess.js"></script>

		<script>

			// Init
			var scene = new THREE.Scene();

			var width = window.innerWidth;
			var height = window.innerHeight;
			var camera = new THREE.PerspectiveCamera(60, width / height, 1, 1000);
			camera.position.set(-10, 7, -10);

			var renderer = new THREE.WebGLRenderer( {antialias: true} );
			renderer.setPixelRatio(window.devicePixelRatio);
			renderer.setSize(width, height);
			document.body.appendChild(renderer.domElement);

			var objects = [];

			var axesHelper = new THREE.AxesHelper(10);
			scene.add(axesHelper);

			// Controls
			var orbitControls = new THREE.OrbitControls(camera, renderer.domElement);
			orbitControls.minDistance = 2;
			orbitControls.maxDistance = 100;
			orbitControls.enablePan = false;
			orbitControls.zoomSpeed = 1.0;
			orbitControls.rotateSpeed = 1.0;
			orbitControls.minPolarAngle = 0;
			orbitControls.maxPolarAngle = Math.PI;

			var dragControls = new THREE.DragControls(objects, camera, renderer.domElement);
			dragControls.addEventListener('dragstart', function() {
				orbitControls.enabled = false;
			});
			dragControls.addEventListener('dragend', function() {
				orbitControls.enabled = true;
			});
			
			
			// World
			//var geometry = new THREE.BoxGeometry(1, 1, 1);
			//var material = new THREE.MeshBasicMaterial( {color: 0x00ff00} );
			//var cube = new THREE.Mesh(geometry, material);
			//scene.add(cube);
			//objects.push(cube);

			var squarePlanes = new THREE.Group();

			board.forEach( function(file, indexFile) {
				file.forEach( function(column, indexColumn) { 
					column.forEach( function(square, indexSquare) {
						if(!(square === null)) {
							var geometry = new THREE.PlaneGeometry();
							var material = new THREE.MeshBasicMaterial( {color: 0xfafcb8,
																		 side: THREE.DoubleSide} );
							var plane = new THREE.Mesh(geometry, material);
							//plane.position = new THREE.Vector3(indexFile, indexSquare * 2, indexColumn);
							plane.position.x = indexFile;
							plane.position.y = indexSquare * 2;
							plane.position.z = indexColumn;

							plane.rotateX(Math.PI / 2);

							squarePlanes.add(plane);
						}
					} );
				} );
			} );

			// Center board on origin
			squarePlanes.position.x -= 2.5;
			squarePlanes.position.y -= 4;
			squarePlanes.position.z -= 4.5;

			scene.add(squarePlanes);

			// Window Resizing
			function onWindowResize() {
				camera.aspect = window.innerWidth / window.innerHeight;
				camera.updateProjectionMatrix();

				renderer.setSize(window.innerWidth, window.innerHeight);
			}

			window.addEventListener('resize', onWindowResize, false);

			// Animation loop
			function animate() {
				requestAnimationFrame(animate);
				//cube.rotation.x += 0.01;
				//cube.rotation.y += 0.01;
				renderer.render(scene, camera);
			}

			animate();

		</script>
	</body>

<html>
